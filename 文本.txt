#include <graphics.h>
#include <windows.h>

// 点击EasyX窗口内的指定相对坐标
void click_win_point(int rel_x, int rel_y)
{
    // 获取窗口在屏幕上的左上角位置
    RECT win_rect;
    GetWindowRect(GetHWnd(), &win_rect);
    // 计算目标点的屏幕绝对坐标
    int screen_x = win_rect.left + rel_x;
    int screen_y = win_rect.top + rel_y;

    INPUT input = { 0 };
    input.type = INPUT_MOUSE;
    // 转换为SendInput要求的0-65535绝对坐标范围
    input.mi.dx = (LONG)(screen_x * 65535.0f / GetSystemMetrics(SM_CXSCREEN));
    input.mi.dy = (LONG)(screen_y * 65535.0f / GetSystemMetrics(SM_CYSCREEN));

    // 发送左键按下+松开事件，实现点击
    input.mi.dwFlags = MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_ABSOLUTE;
    SendInput(1, &input, sizeof(INPUT));
    input.mi.dwFlags = MOUSEEVENTF_LEFTUP | MOUSEEVENTF_ABSOLUTE;
    SendInput(1, &input, sizeof(INPUT));
}

int main()
{
    // 初始化600x600的EasyX窗口
    initgraph(600, 600);

    // 直接点击窗口内(550, 10)的位置
    click_win_point(550, 10);

    getch();  // 按任意键关闭窗口
    closegraph();
    return 0;
}